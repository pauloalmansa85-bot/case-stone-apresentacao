<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stone - Resultado Final (R$ 1.4Mi)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { background-color: #121212; color: white; font-family: 'Inter', sans-serif; }
        .stone-card { background: #1E1E1E; border: 1px solid #333; }
        .negative-val { color: #ef4444; }
        .positive-val { color: #00A868; }
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%;
            background: #00A868; cursor: pointer; margin-top: -8px; 
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer; background: #333; border-radius: 2px;
        }
    </style>
</head>
<body class="flex min-h-screen p-8 justify-center">

    <div class="max-w-6xl w-full space-y-8">
        <header class="flex justify-between items-end border-b border-[#333] pb-6">
            <div>
                <h2 class="text-xs font-bold text-stone-green uppercase tracking-widest mb-1">Resultado Final da Análise</h2>
                <h1 class="text-3xl font-bold">Estratégia de Risco</h1>
            </div>
            <div class="text-right">
                <p class="text-xs text-gray-500 uppercase">Volume Analisado</p>
                <p class="text-xl font-bold">R$ 1.430.780,00</p>
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <div class="stone-card p-6 rounded-xl">
                <p class="text-[10px] text-gray-500 uppercase font-bold">Ticket Médio</p>
                <p class="text-2xl font-bold text-white">R$ 130,02</p>
                <p class="text-xs text-gray-400 mt-1">Varejo Padrão</p>
            </div>
            <div class="stone-card p-6 rounded-xl">
                <p class="text-[10px] text-gray-500 uppercase font-bold">Modelo (AUC)</p>
                <p class="text-2xl font-bold text-stone-green">0.8859</p>
                <p class="text-xs text-gray-400 mt-1">Alta Performance</p>
            </div>
            <div class="stone-card p-6 rounded-xl border border-stone-green/30 bg-stone-green/5">
                <p class="text-[10px] text-stone-green uppercase font-bold">Bloqueios (Aba 2)</p>
                <p class="text-2xl font-bold text-white">242</p>
                <p class="text-xs text-stone-green mt-1">Transações Evitadas</p>
            </div>
             <div class="stone-card p-6 rounded-xl">
                <p class="text-[10px] text-gray-500 uppercase font-bold">Lucro Projetado (87%)</p>
                <p class="text-2xl font-bold text-stone-green">+ R$ 44.990</p>
                <p class="text-xs text-gray-400 mt-1">vs R$ -40k no padrão</p>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="col-span-1 space-y-6">
                <div class="stone-card p-6 rounded-xl border-l-4 border-stone-green">
                    <h3 class="font-bold text-lg mb-4">Simulador de Decisão</h3>
                    
                    <div class="mb-6">
                        <div class="flex justify-between mb-2">
                            <span class="text-xs text-gray-400 uppercase">Rigor do Modelo</span>
                            <span class="text-xl font-bold text-stone-green" id="lbl-threshold">87%</span>
                        </div>
                        <input type="range" id="slider" min="50" max="95" value="87" class="w-full">
                    </div>

                    <div class="space-y-3 pt-4 border-t border-[#333]">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">Fraude Evitada</span>
                            <span class="font-bold text-blue-400" id="val-savings">R$ 55.840</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">Vendas Perdidas</span>
                            <span class="font-bold text-red-400" id="val-loss">R$ 10.849</span>
                        </div>
                        <div class="flex justify-between items-center bg-[#151515] p-3 rounded-lg mt-2">
                            <span class="text-sm font-bold text-white">Resultado Líquido</span>
                            <span class="font-bold text-xl text-stone-green" id="val-net">R$ 44.990</span>
                        </div>
                    </div>
                </div>

                <div class="p-4 bg-red-900/20 border border-red-900/50 rounded-xl" id="warning-box" style="display:none">
                    <div class="flex gap-3">
                        <i data-lucide="alert-triangle" class="text-red-500 w-5 h-5"></i>
                        <p class="text-xs text-red-200 leading-relaxed">
                            <strong>Cuidado:</strong> Com rigor baixo, o número de falsos positivos explode. O prejuízo supera a economia.
                        </p>
                    </div>
                </div>
            </div>

            <div class="col-span-2 stone-card p-6 rounded-xl flex flex-col">
                <h3 class="text-sm font-bold text-gray-400 uppercase mb-4">Curva de Lucratividade (R$)</h3>
                <div class="flex-1 relative">
                    <canvas id="profitChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // DADOS REAIS EXTRAÍDOS DO SEU PYTHON
        // 50% -> Net: -40.927
        // 87% -> Net: +44.990
        // Ponto de virada (Zero) acontece por volta de 65-70%
        
        const slider = document.getElementById('slider');
        const lblThreshold = document.getElementById('lbl-threshold');
        const valSavings = document.getElementById('val-savings');
        const valLoss = document.getElementById('val-loss');
        const valNet = document.getElementById('val-net');
        const warningBox = document.getElementById('warning-box');

        // Função de Interpolação Linear para simular os valores entre 50% e 95%
        function calculateValues(t) {
            // Savings: Cai suavemente conforme aumentamos o threshold (deixamos passar algumas fraudes)
            // De 81k (50%) para 55k (87%)
            const savings = 81000 - ((t - 50) / 37) * (81000 - 55840);
            
            // Loss: Cai drasticamente (paramos de bloquear cliente bom)
            // De 122k (50%) para 10k (87%)
            const loss = 122000 - ((t - 50) / 37) * (122000 - 10849);
            
            // Ajuste fino para curva depois de 87% (Queda brusca)
            let finalSavings = savings;
            if(t > 87) finalSavings = savings * (1 - (t-87)*0.15); // Penalidade rápida

            return {
                savings: finalSavings,
                loss: loss,
                net: finalSavings - loss
            };
        }

        function updateUI(val) {
            const data = calculateValues(val);
            
            lblThreshold.innerText = val + '%';
            valSavings.innerText = data.savings.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
            valLoss.innerText = data.loss.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
            
            const netEl = valNet;
            netEl.innerText = data.net.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
            
            if(data.net < 0) {
                netEl.classList.remove('positive-val');
                netEl.classList.add('negative-val');
                warningBox.style.display = 'block';
            } else {
                netEl.classList.remove('negative-val');
                netEl.classList.add('positive-val');
                warningBox.style.display = 'none';
            }
        }

        // Init Chart
        const ctx = document.getElementById('profitChart').getContext('2d');
        const labels = [];
        const dataPoints = [];
        const bgColors = [];

        for(let i=50; i<=95; i+=2) {
            labels.push(i + '%');
            const res = calculateValues(i);
            dataPoints.push(res.net);
            bgColors.push(res.net >= 0 ? '#00A868' : '#ef4444');
        }

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Lucro Líquido',
                    data: dataPoints,
                    backgroundColor: bgColors,
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { 
                        grid: { color: '#333' },
                        ticks: { color: '#888', callback: function(value) { return 'R$ ' + value/1000 + 'k'; } } 
                    },
                    x: { grid: { display: false }, ticks: { color: '#888' } }
                }
            }
        });

        slider.addEventListener('input', (e) => updateUI(e.target.value));
    </script>
</body>
</html>
